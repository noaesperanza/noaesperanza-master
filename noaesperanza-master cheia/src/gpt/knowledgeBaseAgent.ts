// src/gpt/knowledgeBaseAgent.ts

interface KnowledgeEntry {
    titulo: string
    conteudo: string
  }
  
  const bancoDeConhecimento: KnowledgeEntry[] = []
  
  export const knowledgeBaseAgent = {
    async executarAcao(message: string): Promise<string> {
      const lower = message.toLowerCase()
  
      // Criar novo conhecimento
      if (lower.includes('criar conhecimento')) {
        const match = message.match(/criar conhecimento (.+?) com o conte√∫do (.+)/i)
        if (!match || match.length < 3) {
          return '‚ö†Ô∏è Formato inv√°lido. Use: criar conhecimento T√≠tulo com o conte√∫do Texto...'
        }
  
        const titulo = match[1].trim()
        const conteudo = match[2].trim()
  
        bancoDeConhecimento.push({ titulo, conteudo })
        return `‚úÖ Conhecimento "${titulo}" adicionado com sucesso.`
      }
  
      // Editar conhecimento
      if (lower.includes('editar conhecimento')) {
        const match = message.match(/editar conhecimento (.+?) com o conte√∫do (.+)/i)
        if (!match || match.length < 3) {
          return '‚ö†Ô∏è Formato inv√°lido. Use: editar conhecimento T√≠tulo com o conte√∫do Novo texto...'
        }
  
        const titulo = match[1].trim()
        const novoConteudo = match[2].trim()
  
        const entry = bancoDeConhecimento.find(k => k.titulo === titulo)
        if (!entry) {
          return `‚ùå Conhecimento "${titulo}" n√£o encontrado.`
        }
  
        entry.conteudo = novoConteudo
        return `‚úÖ Conhecimento "${titulo}" atualizado com sucesso.`
      }
  
      // Listar conhecimentos
      if (lower.includes('listar conhecimentos')) {
        if (bancoDeConhecimento.length === 0) {
          return '‚ÑπÔ∏è Nenhum conte√∫do na base de conhecimento ainda.'
        }
  
        const lista = bancoDeConhecimento
          .map((k, i) => `${i + 1}. ${k.titulo}`)
          .join('\n')
  
        return `üìö Conhecimentos dispon√≠veis:\n${lista}`
      }
  
      return '‚ö†Ô∏è Comando de base de conhecimento n√£o reconhecido. Use: criar, editar ou listar conhecimentos.'
    }
  }
  